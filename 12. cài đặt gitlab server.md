# Cài đặt gitlab server

1. Clone thêm 1 server mới có tên là gitlab server
2. Sửa lại địa chỉ ip cho server

- `vi /etc/netplan/00-installer-config.yaml`: sửa xong thì lưu lại, chạy lệnh `netplan apply`
- kiểm tra lại bằng lệnh `ip a`
- sửa lại host name cho server: `vi /etc/hostname` thành gitlab-server. lưu lại. chạy lệnh reboot

3. Cài gitlab server

- tìm kiếm `gitlab ee package`, sau đó vào tìm gitlab-ee_14.4.1-ee.0_arm64.deb, k cần cài bản mới.

4. tạo url cho gitlab

- sửa file hosts `vi /etc/hosts`
- điền ip cho server khi nãy tạo vào: thêm vào dòng cuối:
  192.168.126.241 git.ndtoan.tech
  (domain này tự tạo, k cần phải có thật)
- lưu lại
- sửa lại url của gitlab, mở file config của gitlab lên, `vi /etc/gitlab/gitlab.rb`, nhìn xuống thấy dòng `external_url`, sửa thành `http://git.ndtoan.tech`, lưu lại
- chạy lệnh gitlab-ctl reconfigure
- config để window có thể truy cập vào link đó được, search cụm từ `host path windows`, vào `C:\Windows\System32\drivers\etc`, copy file hosts ra 1 chỗ khác, thêm dòng `192.168.126.241 git.ndtoan.tech` vào cuối, lưu lại, rồi thay thế file hosts ở trong `C:\Windows\System32\drivers\etc`
- thử truy cập vào trình duyệt, nếu truy cập được là ok, tài khoản mặt định là `root`, còn pw thì vào server, lấy mật khẩu ra, `cat /etc/gitlab/initial_root_password`
- tiếp theo, ta vào **view setting**, bỏ chọn ở các mục `Sign up restriction`, bỏ tự tạo tài khoản, lưu lại
- vào phần CI/CD, vào `Continuous Integration and Deployment`, bỏ chọn ở mục `Default to Auto DevOps pipeline for all projects`. Lưu lại
- tiến hành đổi lại mật khẩu của root, `31253125`
