# CÃ¡c lá»‡nh Nginx thÆ°á»ng dÃ¹ng trong Linux

## 1. Quáº£n lÃ½ dá»‹ch vá»¥ Nginx

| Lá»‡nh                           | Chá»©c nÄƒng                                                                           |
| ------------------------------ | ----------------------------------------------------------------------------------- |
| `sudo systemctl start nginx`   | ğŸ”¹ **Khá»Ÿi Ä‘á»™ng (báº­t)** dá»‹ch vá»¥ Nginx                                                |
| `sudo systemctl stop nginx`    | ğŸ”¹ **Dá»«ng (táº¯t)** dá»‹ch vá»¥ Nginx                                                     |
| `sudo systemctl restart nginx` | ğŸ”¹ **Khá»Ÿi Ä‘á»™ng láº¡i** Nginx (sau khi thay Ä‘á»•i cáº¥u hÃ¬nh)                              |
| `sudo systemctl reload nginx`  | ğŸ”¹ **Táº£i láº¡i cáº¥u hÃ¬nh** mÃ  **khÃ´ng ngáº¯t káº¿t ná»‘i hiá»‡n táº¡i** (ráº¥t há»¯u Ã­ch khi deploy) |
| `sudo systemctl status nginx`  | ğŸ”¹ **Xem tráº¡ng thÃ¡i** dá»‹ch vá»¥ Nginx (Ä‘ang cháº¡y, dá»«ng, lá»—i, v.v.)                    |
| `sudo systemctl enable nginx`  | ğŸ”¹ **Tá»± Ä‘á»™ng khá»Ÿi Ä‘á»™ng Nginx khi mÃ¡y báº­t láº¡i (boot)**                               |
| `sudo systemctl disable nginx` | ğŸ”¹ **Táº¯t tá»± Ä‘á»™ng khá»Ÿi Ä‘á»™ng cÃ¹ng há»‡ thá»‘ng**                                          |

## 2. Kiá»ƒm tra vÃ  quáº£n lÃ½ cáº¥u hÃ¬nh

| Lá»‡nh                   | Chá»©c nÄƒng                                                                  |
| ---------------------- | -------------------------------------------------------------------------- |
| `sudo nginx -t`        | âœ… **Kiá»ƒm tra file cáº¥u hÃ¬nh Nginx cÃ³ há»£p lá»‡ khÃ´ng** (trÆ°á»›c khi restart)    |
| `sudo nginx -v`        | ğŸ” **Xem phiÃªn báº£n** Nginx hiá»‡n táº¡i                                        |
| `sudo nginx -V`        | ğŸ” Xem chi tiáº¿t **phiÃªn báº£n + module Ä‘Æ°á»£c biÃªn dá»‹ch** cÃ¹ng Nginx           |
| `sudo nginx -s reload` | ğŸ” **Táº£i láº¡i cáº¥u hÃ¬nh Nginx (reload)** â€” tÆ°Æ¡ng tá»± `systemctl reload nginx` |
| `sudo nginx -s stop`   | â›” **Dá»«ng** Nginx                                                          |
| `sudo nginx -s quit`   | ğŸ”¸ Dá»«ng **an toÃ n** (káº¿t thÃºc sau khi xá»­ lÃ½ xong káº¿t ná»‘i hiá»‡n táº¡i)         |
| `sudo nginx -s reopen` | ğŸ”¹ **Má»Ÿ láº¡i file log** (náº¿u báº¡n vá»«a xoay log â€” log rotation)               |

## 3. ThÆ° má»¥c & file cáº¥u hÃ¬nh quan trá»ng

| ÄÆ°á»ng dáº«n                     | Má»¥c Ä‘Ã­ch                                                                                                   |
| ----------------------------- | ---------------------------------------------------------------------------------------------------------- |
| `/etc/nginx/nginx.conf`       | âš™ï¸ File cáº¥u hÃ¬nh chÃ­nh cá»§a Nginx                                                                           |
| `/etc/nginx/sites-available/` | ğŸ“‚ Chá»©a cÃ¡c cáº¥u hÃ¬nh tá»«ng website (vhost)                                                                  |
| `/etc/nginx/sites-enabled/`   | ğŸ”— Chá»©a **symlink** trá» Ä‘áº¿n cÃ¡c file trong `sites-available/` (chá»‰ site nÃ o link á»Ÿ Ä‘Ã¢y má»›i Ä‘Æ°á»£c kÃ­ch hoáº¡t) |
| `/var/log/nginx/access.log`   | ğŸ“œ Log truy cáº­p (access logs)                                                                              |
| `/var/log/nginx/error.log`    | âš ï¸ Log lá»—i (error logs)                                                                                    |

## 4. Má»™t sá»‘ lá»‡nh giÃ¡m sÃ¡t & debug há»¯u Ã­ch

| Lá»‡nh                                     | Chá»©c nÄƒng                                                               |                                                                   |
| ---------------------------------------- | ----------------------------------------------------------------------- | ----------------------------------------------------------------- |
| `sudo tail -f /var/log/nginx/access.log` | ğŸ‘ï¸ Xem **log truy cáº­p theo thá»i gian thá»±c**                             |                                                                   |
| `sudo tail -f /var/log/nginx/error.log`  | ğŸ‘ï¸ Xem **log lá»—i theo thá»i gian thá»±c**                                  |                                                                   |
| `sudo netstat -tulnp nginx`              | grep                                                                    | ğŸ” Kiá»ƒm tra Nginx Ä‘ang láº¯ng nghe cá»•ng nÃ o (80, 443, â€¦)            |
| `curl -I http://localhost`               | ğŸ§ª Kiá»ƒm tra pháº£n há»“i HTTP header tá»« Nginx                               |                                                                   |
| `ps aux   nginx`                         | grep                                                                    | ğŸ“‹ Xem **tiáº¿n trÃ¬nh Nginx** Ä‘ang cháº¡y (master & worker processes) |
| `nginx -T`                               | ğŸ“„ Xuáº¥t toÃ n bá»™ cáº¥u hÃ¬nh hiá»‡n táº¡i cá»§a Nginx ra mÃ n hÃ¬nh (dÃ¹ng Ä‘á»ƒ debug) |                                                                   |

## 5. CÃ¡c tráº¡ng thÃ¡i thÆ°á»ng gáº·p

| Tráº¡ng thÃ¡i         | Ã nghÄ©a                                 |
| ------------------ | --------------------------------------- |
| `active (running)` | âœ… Nginx Ä‘ang cháº¡y bÃ¬nh thÆ°á»ng          |
| `inactive (dead)`  | âŒ Dá»‹ch vá»¥ Ä‘Ã£ dá»«ng                      |
| `failed`           | âš ï¸ Cáº¥u hÃ¬nh lá»—i hoáº·c khá»Ÿi Ä‘á»™ng tháº¥t báº¡i |
| `reloading`        | ğŸ” Äang táº£i láº¡i cáº¥u hÃ¬nh má»›i            |

## 6. VÃ­ dá»¥ quy trÃ¬nh lÃ m viá»‡c cÆ¡ báº£n

Giáº£ sá»­ báº¡n vá»«a chá»‰nh sá»­a file cáº¥u hÃ¬nh `/etc/nginx/sites-available/myapp`, báº¡n nÃªn lÃ m:

```
sudo nginx -t           # BÆ°á»›c 1: kiá»ƒm tra cáº¥u hÃ¬nh
sudo systemctl reload nginx   # BÆ°á»›c 2: táº£i láº¡i cáº¥u hÃ¬nh (khÃ´ng cáº§n restart)
sudo systemctl status nginx   # BÆ°á»›c 3: kiá»ƒm tra Nginx Ä‘ang cháº¡y á»•n

```

## 7. LÆ°u Ã½ khi thao tÃ¡c vá»›i Nginx

- LuÃ´n kiá»ƒm tra cáº¥u hÃ¬nh (`nginx -t`) trÆ°á»›c khi reload hoáº·c restart, trÃ¡nh Nginx sáº­p vÃ¬ lá»—i cÃº phÃ¡p.

- Khi chá»‰nh sá»­a file cáº¥u hÃ¬nh, nÃªn táº¡o báº£n sao lÆ°u (backup) trÆ°á»›c:

```
sudo cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup
```

- Náº¿u cáº¥u hÃ¬nh phá»©c táº¡p (nhiá»u site), báº¡n cÃ³ thá»ƒ dÃ¹ng:

```
sudo nginx -T | less
```

Ä‘á»ƒ xem toÃ n bá»™ cáº¥u hÃ¬nh Ä‘Ã£ gá»™p láº¡i.

## 8. TÃ³m táº¯t nhanh

| NhÃ³m lá»‡nh         | VÃ­ dá»¥                                   | Ghi chÃº                       |                  |
| ----------------- | --------------------------------------- | ----------------------------- | ---------------- |
| Quáº£n lÃ½ dá»‹ch vá»¥   | `sudo systemctl restart nginx`          | Dá»«ng / khá»Ÿi Ä‘á»™ng láº¡i Nginx    |                  |
| Kiá»ƒm tra cáº¥u hÃ¬nh | `sudo nginx -t`                         | XÃ¡c thá»±c cáº¥u hÃ¬nh             |                  |
| GiÃ¡m sÃ¡t          | `sudo tail -f /var/log/nginx/error.log` | Theo dÃµi log lá»—i              |                  |
| Reload an toÃ n    | `sudo nginx -s reload`                  | Táº£i láº¡i mÃ  khÃ´ng ngáº¯t káº¿t ná»‘i |                  |
| Xem port          | `sudo netstat -tulnp                    | grep nginx`                   | Xem cá»•ng Ä‘ang má»Ÿ |

Káº¿t luáº­n:Nginx cÃ³ nhiá»u lá»‡nh, nhÆ°ng nhá»¯ng lá»‡nh â€œvÃ ngâ€ báº¡n cáº§n nhá»› nháº¥t khi lÃ m thá»±c táº¿ lÃ :

```
sudo nginx -t
sudo systemctl reload nginx
sudo systemctl status nginx
sudo tail -f /var/log/nginx/error.log
```
